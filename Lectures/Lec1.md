# INTRO



### 课程主要内容

* Target：理解操作系统的设计和实现；深入了解工作原理；

  * 上手实验XV6操作系统，扩展操作系统、修改、提升操作系统，操作系统接口，编写系统软件。
* 市面上的操作系统做了哪些事情

  * **抽象硬件**。实现进程、文件系统等
  * 在多个应用程序之间**共用硬件资源**
  * 程序之间需要有一定的**隔离性**
  * 程序之间也要可以**共享**
  * **多用户**的隔离、数据安全
  * 帮助程序达到**高性能**


---

### 主流操作系统结构

<img src="/Users/liuwenshuo/Documents/Notes/6.s801/Lectures/OS%20Structure.png" alt="OS Structure" style="zoom: 33%;" />

---

### 系统调用

* read： 读取文件中的内容，在unix一切皆文件！
  * read的三个参数：
* 1. 1. 文件描述符fd：shell确保默认情况下当程序启动时，文件描述符0连接着console的输入，1连接着console的输出。当我们想从命令行中读入一行文字时，将这个值设为0即可。
     2. 指向某段内存的指针：读入的内容存放的初始地址
     3. 最大长度：读入的最大长度

* write： 和read类似，参数也是一致的，只是参数fd在需要向console输出时设置为1

* exit：退出当前进程

* open：参数是文件路径和权限符。如果不存在该文件会自动创建。作用是将这个文件描述符添加到当前进程的打开文件表中。返回值是文件的描述符fd。

* fork：创建子进程，返回值是子进程的pid。在一个程序中，可以用这个pid判断是当前进程还是子进程，用于控制两个进程的执行。

* wait：等待当前进程创建的子进程结束。带一个参数是整型的指针，用来接收子进程结束的返回值。

* pipe：管道是两个进程之间的连接，用于进程间通信。相当于一块内存中的"虚拟文件"

  * 管道只是单向通信，一个进程写入数据，另一个进程读数据，这不能改变。

  * 管道可以被创建的进程及其所有子进程读取和写入。

  * 如果进程在将某些内容写入管道之前，尝试读取管道，则读取进程将暂停直到写入完成

  * pipe系统调用会在进程的打开文件表中找到前两个可用位置，将他们分配给管道的两端。

  * pipe是FIFO的队列，可以写入512个byte的数据，但一次只能读取1byte

  * 如果我们在创建管道后调用 fork，那么父子可以通过管道进行通信

  * ```c
    语法：
    int pipe(int fds[2]);
    Parameters :
    fd[0] will be the fd(file descriptor) for the 
    read end of pipe.
    fd[1] will be the fd for the write end of pipe.
    Returns : 0 on Success.
    -1 on error.
    ```